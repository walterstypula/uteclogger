/*
 * Created by SharpDevelop.
 * User: Walter
 * Date: 10/25/2011
 * Time: 7:54 PM
 * 
 * $
{
res:XML.StandardHeader.HowToChangeTemplateInformation
}
 */
using System;
using System.IO.Ports;
using System.Threading;
using System.Collections.Generic;

namespace UTEC.DAL
{
	/// <summary>
	/// Description of UtecSerialConn.
	/// </summary>
	public class UtecSerialConn
	{
		
		#region Constants
		private const int BYTES_TO_READ = 1;
		private const string LOGGER_1 = "1";
		#endregion
		
		#region Delegates and Events
		public delegate void DataReceivedEventHandler(object sender, string e);
		public delegate void ErrorReceivedEventHandler(object sender, Exception ex);
		public event DataReceivedEventHandler DataReceived;
		public event ErrorReceivedEventHandler ErrorReceived;
		#endregion

		#region Private Fields
		private SerialPort comPort;
		private Thread worker;
		private bool continueRunning = false;
		private int sampleLinePacketIndex = 0; // this is only used for testmode.
		#endregion
		
		#region Constructors
		
		public UtecSerialConn(string comPortName)
		{
			if (!new List<string>(SerialPortHelper.GetPortNames()).Contains(comPortName))
			{
				throw new ArgumentException(comPortName + ", is invalid.");
			}

			comPort = InitializeSerialConnection(comPortName);
			LinesPerSecond = 15;
			FastLogging = false;
		}
		
		#endregion
		
		#region Properties
		public string LatestReading
		{
			get;private set;
		}
		
		public bool FastLogging
		{
			get;set;
		}
		
		public int LinesPerSecond
		{
			get;set;
		}
		
		public bool TestMode
		{
			get;set;
		}
		
		public bool IsOpen
		{
			get{return continueRunning;}
		}
		#endregion
		
		#region Private Methods
		/// <summary>
		/// This method is only used for test mode
		/// </summary>
		/// <returns>line of test data</returns>
		private String GetLineFromSamplePacket()
		{
			var lines = utecSampleData.Split(Environment.NewLine.ToCharArray());

			if (sampleLinePacketIndex >= lines.Length)
			{
				sampleLinePacketIndex = 0;
			}

			Thread.Sleep(TimeSpan.FromMilliseconds(10));

			return lines[sampleLinePacketIndex++];
		}
		
		private SerialPort InitializeSerialConnection(String comPortName)
		{
			var sp = new SerialPort();
			sp.PortName = comPortName;
			sp.BaudRate = 19200;
			sp.DataBits = 8;
			sp.Parity = Parity.None;
			sp.StopBits = StopBits.One;
			sp.WriteTimeout = 1000;
			sp.Handshake = Handshake.RequestToSend;
			return sp;
		}
		
		private void Read()
		{
			while (continueRunning)
			{
				try
				{
					String line = null;

					if (TestMode)
					{
						line = GetLineFromSamplePacket();
						OnSetLatestReading(line);
					}
					else
					{
						if(comPort.BytesToRead > BYTES_TO_READ)
						{
							line = comPort.ReadLine();
							OnSetLatestReading(line);
						}
						
						if(FastLogging)
						{
							comPort.Write(LOGGER_1);
							Thread.Sleep(1000/LinesPerSecond);
						}
					}
				}
				catch (ThreadInterruptedException)
				{
					// nothing
				}
				catch(TimeoutException tex)
				{
					this.OnErrorReceived(tex);
				}
				catch(Exception ex)
				{
					this.OnErrorReceived(ex);
				}
			}
			
		}
		
		private void OnSetLatestReading(string line)
		{
			if (line != null && 0 != line.Trim().Length)
			{
				LatestReading = line;
				
				if (DataReceived != null)
				{
					DataReceived(this, line);
				}
			}
		}
		
		private void OnErrorReceived(Exception ex)
		{
			if(ErrorReceived != null)
			{
				ErrorReceived(this, ex);
			}
		}
		
		#endregion
		
		#region Public Methods
		
		public void Dispose()
		{
			Stop();
		}

		public void Start()
		{
			if (continueRunning == false)
			{
				comPort.Open();
				continueRunning = true;
				worker = new Thread(Read);
				worker.Start();
			}
			else
			{
				throw new InvalidOperationException("Already started.");
			}
		}

		public void Stop()
		{
			if (continueRunning == true)
			{
				continueRunning = false;
				worker.Join();
				comPort.Close();
			}
		}
		
		#endregion
		
		#region Sample Data
		
		#region UTEC WITH TXS TUNER SAMPLE
		string utecWithTunerSample = @"2754 +0.2 2.6 77 10 00 W/B +34.8 9.9 +34.6 85 ECU. 2.9 14.61
2743 +0.2 2.6 92 10 00 W/B +34.7 10.1 +34.6 85 ECU. 3.0 14.78
2810 +0.4 2.6 101 10 00 W/B +34.8 10.3 +34.6 86 .00 2.9 14.96
2827 +0.4 2.7 102 10 00 W/B +34.7 10.3 +34.6 86 99.00 2.9 15.02
2803 +0.6 2.7 101 10 00 W/B +34.3 10.4 +34.6 86 WGS. 3.0 15.02
2827 +0.4 2.6 101 10 00 W/B +34.3 10.4 +34.6 86 WGS. 3.0 15.02
2871 +0.6 2.6 101 10 00 W/B +33.9 10.8 +34.6 86 WGS. 3.0 14.96
2891 +0.6 2.6 101 10 00 W/B +34.1 10.8 +34.6 87 WGS. 3.0 14.92
2888 +0.8 2.7 101 10 00 W/B +33.7 10.9 +34.6 87 WGS. 3.0 14.87
2898 +0.8 2.7 101 10 00 W/B +33.6 11.2 +34.6 88 WGS. 3.0 14.78
2936 +1.0 2.7 101 10 00 W/B +33.2 11.5 +34.6 88 WGS. 3.0 14.65
2965 +1.0 2.7 101 10 00 W/B +32.8 11.6 +34.6 88 WGS. 3.0 14.58
2984 +1.0 2.7 101 10 00 W/B +32.3 11.7 +34.6 89 WGS. 3.0 14.49
2970 +1.2 2.7 101 10 00 W/B +32.0 11.9 +34.6 89 WGS. 3.0 14.49
2962 +1.2 2.7 101 10 00 W/B +30.9 11.9 +34.6 89 WGS. 3.1 14.42
3016 +1.4 2.7 101 10 00 W/B +31.6 12.1 +34.6 90 WGS. 3.0 14.33
3022 +1.4 2.7 101 10 00 W/B +30.6 12.3 +34.6 90 WGS. 3.1 14.22
3044 +1.5 2.7 101 10 00 W/B +28.9 12.3 +34.6 91 WGS. 3.0 14.15
3077 +1.5 2.8 101 10 00 W/B +28.5 12.7 +34.6 91 WGS. 3.1 14.08
3095 +1.5 2.8 101 10 00 W/B +28.3 12.8 +34.6 91 WGS. 3.0 14.00
3080 +1.5 2.8 101 10 00 W/B +28.9 12.7 +34.6 91 WGS. 3.1 13.95
3077 +1.7 2.8 101 10 00 W/B +27.6 13.1 +34.6 91 WGS. 3.1 13.95
3132 +1.9 2.8 101 10 00 W/B +27.2 13.2 +34.6 92 WGS. 3.1 13.84
3180 +1.7 2.8 101 10 00 W/B +27.0 13.5 +34.6 92 WGS. 3.2 13.78
3180 +1.9 2.8 101 10 00 W/B +26.8 13.6 +34.6 92 WGS. 3.2 13.72
3211 +2.1 2.8 101 10 00 W/B +26.7 13.9 +34.6 92 WGS. 3.2 13.65
3233 +2.1 2.9 101 10 00 W/B +26.5 14.1 +34.6 93 WGS. 3.3 13.65
3223 +2.1 2.9 101 10 00 W/B +25.4 14.4 +34.0 93 WGS. 3.3 13.65
3233 +2.3 2.9 101 10 00 W/B +24.3 14.8 +33.7 93 WGS. 3.2 13.65
3300 +2.5 2.9 101 20 00 W/B +22.1 14.4 +33.3 92 WGS. 3.3 13.65
3280 +2.5 2.9 101 20 00 W/B +20.4 14.7 +33.2 92 WGS. 3.3 13.65
3287 +2.5 2.9 101 20 00 W/B +17.5 14.8 +32.4 92 WGS. 3.2 13.65
3367 +2.6 2.9 101 20 00 W/B +16.2 14.9 +32.3 92 WGS. 3.3 13.72
3380 +2.6 3.0 101 20 00 W/B +14.3 15.1 +30.7 92 WGS. 3.3 13.75
3370 +2.8 3.0 101 20 00 W/B +13.0 15.4 +30.7 92 98.90 3.2 13.81
3432 +2.8 3.0 101 20 00 W/B +11.8 15.6 +29.9 91 98.90 3.4 13.87
3450 +3.0 3.1 101 20 00 W/B +12.0 15.8 +29.1 91 98.80 3.4 13.97
3454 +3.0 3.1 101 20 00 W/B +11.9 15.7 +29.0 90 98.80 3.5 13.97
3475 +3.2 3.0 101 20 00 W/B +11.8 15.9 +27.7 90 98.70 3.4 14.08
3497 +3.4 2.9 101 20 00 W/B +11.7 16.1 +27.4 90 98.70 3.4 14.15
3561 +3.6 2.9 101 20 00 W/B +11.8 16.3 +26.5 89 98.70 3.5 14.22
3542 +3.6 3.0 101 20 00 W/B +11.9 16.4 +25.9 88 98.60 3.3 14.37
3546 +3.7 3.2 101 20 00 W/B +11.8 16.4 +25.8 88 98.60 3.6 14.49
3572 +3.9 3.2 101 20 00 W/B +11.7 16.8 +25.6 87 98.50 3.5 14.65
3646 +3.9 3.1 101 20 00 W/B +11.9 16.7 +23.9 87 98.40 3.4 14.74
3635 +3.9 3.1 101 20 00 W/B +11.5 16.7 +23.2 86 98.40 3.5 14.83
3639 +4.3 3.1 101 20 00 W/B +11.2 17.3 +23.2 86 98.30 3.7 14.83
3720 +4.5 3.1 101 20 00 W/B +11.5 17.3 +22.6 85 98.20 3.6 14.92
3720 +4.5 3.1 101 30 00 W/B +11.5 17.5 +22.5 85 98.20 3.5 15.08
3766 +4.7 3.3 101 30 00 W/B +11.5 17.5 +22.5 84 98.10 3.5 15.18
3745 +5.0 3.3 101 30 00 W/B +11.4 18.0 +22.4 85 98.00 3.6 15.24
3818 +5.0 3.3 101 30 00 W/B +11.4 18.4 +22.3 84 94.90 3.6 15.24
3800 +5.4 3.3 101 30 00 W/B +11.0 18.7 +22.2 85 94.70 3.6 15.24
3835 +5.6 3.2 101 30 00 W/B +11.0 18.6 +22.0 83 94.60 3.8 15.08
3796 +5.8 3.4 101 30 00 W/B +10.5 19.1 +22.0 83 94.60 3.7 15.08
3963 +6.1 3.4 101 30 00 W/B +10.7 19.6 +21.9 84 94.40 3.8 14.87
4040 +6.3 3.4 101 30 00 W/B +10.3 20.1 +21.8 81 90.40 3.7 14.61
3968 +6.5 3.3 101 30 00 W/B +9.7 19.9 +21.6 81 90.40 3.8 14.33
3880 +6.7 3.3 101 40 00 W/B +9.1 20.0 +21.4 80 90.20 3.9 14.08
3987 +6.9 3.3 101 40 00 W/B +9.2 20.9 +21.3 84 90.20 3.8 13.81
4095 +7.2 3.3 101 40 00 W/B +9.1 21.8 +20.9 80 90.10 3.8 13.56
4016 +7.6 3.5 101 40 00 W/B +8.7 22.0 +20.8 79 89.90 3.9 13.28
4016 +7.8 3.5 101 40 00 W/B +8.5 22.3 +20.4 85 85.20 4.0 13.28
4151 +8.0 3.6 101 40 00 W/B +8.4 24.2 +20.1 82 85.10 3.9 13.09
4120 +8.5 3.5 101 40 00 W/B +8.4 25.8 +19.9 83 85.00 4.0 12.93
4115 +8.7 3.5 101 40 00 W/B +8.5 25.6 +19.6 88 84.80 4.0 12.81
4214 +9.1 3.6 101 50 00 W/B +8.6 26.7 +19.5 87 84.70 4.0 12.68
4161 +9.6 3.6 101 50 00 W/B +8.4 27.2 +19.2 85 78.70 4.1 12.64
4334 +10.0 3.7 101 50 00 W/B +8.5 28.9 +19.1 86 78.60 4.2 12.56
4257 +10.4 3.7 101 50 00 W/B +8.5 30.6 +19.2 81 78.50 4.1 12.46
4306 +11.1 3.7 101 60 00 W/B +8.5 31.6 +19.2 84 78.20 4.1 12.46
4468 +11.7 3.8 101 60 00 W/B +8.3 31.4 +19.2 87 77.90 4.2 12.39
4510 +12.0 3.8 101 60 00 W/B +8.0 34.2 +19.1 86 77.70 4.3 12.25
4566 +12.6 3.8 101 60 00 W/B +7.6 34.7 +18.7 87 70.00 4.3 12.14
4391 +13.3 3.9 101 60 00 W/B +7.3 36.3 +18.0 86 69.90 4.3 12.02
4616 +13.9 3.9 101 70 00 W/B +7.1 38.2 +17.7 90 69.50 4.3 11.92
4516 +15.0 4.0 101 70 00 W/B +6.7 40.2 +17.1 88 69.20 4.5 11.81
4559 +15.9 4.1 101 80 00 W/B +6.6 41.6 +16.9 87 68.80 4.6 11.68
4591 +16.8 4.1 101 80 00 W/B +6.6 42.8 +16.4 85 68.00 4.6 11.68
4823 +17.9 4.2 101 90 00 W/B +6.3 43.9 +16.5 87 67.50 4.6 11.62
4837 +19.0 4.2 101 90 00 W/B +6.8 47.3 +16.5 89 67.00 4.6 11.62
4728 +20.1 4.2 101 100 00 W/B +7.1 53.7 +16.5 86 66.80 4.6 11.62
4803 +21.0 4.2 101 100 00 W/B +7.0 52.8 +16.5 88 66.40 4.6 11.65
4810 +21.6 4.3 101 100 00 W/B +6.9 55.0 +16.5 93 66.40 4.6 11.68
4916 +21.6 4.4 101 100 00 W/B +7.0 56.0 +16.5 94 66.40 4.6 11.71
4967 +21.8 4.4 101 100 00 W/B +6.9 58.2 +16.5 92 66.40 4.6 11.73
5020 +21.6 4.4 101 100 00 W/B +7.3 57.2 +16.5 94 66.50 4.6 11.73
5184 +21.4 4.4 101 100 00 W/B +7.2 57.8 +16.8 94 66.50 4.6 11.77
5144 +21.6 4.4 101 100 00 W/B +7.3 58.3 +17.1 94 66.50 4.6 11.76
5159 +21.6 4.5 101 100 00 W/B +7.9 59.4 +17.3 95 66.50 4.6 11.73
5200 +21.4 4.5 101 100 00 W/B +7.8 60.4 +17.3 95 66.50 4.6 11.77
5265 +21.4 4.5 101 100 00 W/B +7.9 60.4 +17.5 95 66.50 4.6 11.80
5333 +21.4 4.5 101 100 00 W/B +7.9 61.2 +17.5 97 66.50 4.6 11.81
5393 +21.2 4.5 101 100 00 W/B +8.0 63.0 +17.5 98 66.60 4.6 11.81
5500 +21.4 4.5 101 100 00 W/B +7.9 64.7 +17.5 98 66.60 4.6 11.81
5411 +21.2 4.5 101 100 00 W/B +8.2 64.3 +17.5 100 66.60 4.6 11.81
5574 +21.0 4.5 101 100 00 W/B +8.8 66.4 +17.6 100 66.60 4.6 11.87
5592 +21.0 4.6 101 100 00 W/B +8.6 66.3 +18.0 100 66.70 4.6 11.93
5583 +21.0 4.6 101 100 00 W/B +9.0 67.5 +18.1 101 66.60 4.6 11.98
5727 +21.0 4.7 101 100 00 W/B +8.9 66.8 +18.5 102 66.60 4.6 12.00
5698 +21.0 4.7 101 100 00 W/B +9.2 69.0 +18.5 102 66.70 4.6 12.02
5767 +20.9 4.6 101 100 00 W/B +9.5 68.7 +18.5 102 66.70 4.6 12.05
5787 +20.9 4.6 101 100 00 W/B +9.4 68.7 +18.6 102 66.80 4.6 12.05
6006 +20.7 4.6 101 100 00 W/B +9.5 70.4 +18.5 102 66.70 4.6 12.06
5941 +20.9 4.6 101 100 00 W/B +10.7 71.8 +18.6 103 66.80 4.6 12.11
6127 +20.7 4.6 101 100 00 W/B +10.5 71.5 +18.6 103 66.80 4.6 12.06
6060 +20.7 4.7 101 100 00 W/B +10.8 71.7 +18.9 103 66.80 4.6 12.11
6116 +20.7 4.6 101 100 00 W/B +11.1 72.0 +19.2 103 66.80 4.6 12.11
6289 +20.5 4.6 101 100 00 W/B +11.7 72.7 +19.8 103 66.80 4.6 12.11
6150 +20.5 4.7 101 100 00 W/B +11.5 73.0 +19.9 103 66.80 4.6 12.14
6361 +20.5 4.7 101 100 00 W/B +11.4 74.1 +20.8 104 66.80 4.6 12.14
6138 +20.5 4.6 101 100 00 W/B +11.8 76.0 +21.1 104 67.00 4.6 12.14
6397 +20.3 4.6 101 100 00 W/B +12.2 75.2 +21.3 105 67.00 4.6 12.17
6313 +20.1 4.6 101 100 00 W/B +12.2 76.5 +20.9 105 66.90 4.6 12.14
6535 +20.3 4.7 101 100 00 W/B +12.2 78.4 +21.8 106 67.00 4.6 12.11
6574 +20.3 4.7 101 100 00 W/B +12.6 80.1 +21.1 105 66.90 4.6 12.11
6640 +20.1 4.7 101 100 00 W/B +12.5 78.9 +22.1 106 66.90 4.6 12.11
6459 +20.3 4.7 101 100 00 W/B +12.7 80.8 +21.7 105 66.90 4.6 12.06
6680 +20.3 4.7 101 100 00 W/B +13.0 80.3 +22.4 106 66.80 4.6 12.06
6653 +20.5 4.7 101 100 00 W/B +12.9 82.4 +22.1 106 66.90 4.6 12.06
6788 +20.5 4.7 101 100 00 W/B +13.4 83.1 +22.9 106 66.80 4.6 12.06
6901 +20.3 4.7 100 100 00 W/B +13.3 84.0 +22.5 107 66.90 4.6 12.02
6915 +20.5 4.7 101 100 00 W/B +13.8 84.5 +22.6 106 66.90 4.6 12.06
6930 +20.3 4.7 101 100 00 W/B +13.6 83.1 +23.9 107 66.80 4.6 12.18
6887 +20.5 4.7 100 100 00 W/B +13.7 84.6 +23.9 107 66.80 4.6 12.25
6858 +20.5 4.7 101 100 00 W/B +13.5 85.7 +23.9 107 66.90 4.6 12.37
7092 +20.3 4.7 101 100 00 W/B +14.1 84.5 +24.7 107 66.90 4.6 12.37
7002 +20.3 4.7 101 100 00 W/B +14.4 84.4 +25.1 106 66.90 4.6 12.45
7002 +20.3 4.7 101 100 00 W/B +14.3 83.7 +24.9 107 66.80 4.6 12.42
7032 +20.3 4.7 101 100 00 W/B +14.8 85.8 +24.9 107 67.00 4.6 12.42
7199 +20.3 4.7 101 100 00 W/B +15.2 85.2 +25.8 106 66.90 4.6 12.46
7215 +20.5 4.7 101 100 00 W/B +15.1 86.5 +25.6 107 66.90 4.6 12.52
7246 +20.5 4.7 101 100 00 W/B +15.5 86.0 +25.2 105 66.80 4.6 12.61
7457 +20.3 4.8 100 100 00 W/B +15.6 89.2 +25.9 105 66.80 4.6 12.78
7293 +20.3 4.7 101 100 00 W/B +15.8 86.9 +26.2 105 66.80 4.6 12.96
7806 +20.5 4.7 82 100 00 W/B +16.7 85.5 +26.2 104 .00 4.6 12.96";
		#endregion
		
		#region UTEC SAMPLE DATA
		string utecSampleData = @" RPM MAP MAF TPS Site Count AFR Ign#1 Inj#1 Ign Fuel Boost MAF
 2360 -4.5 1.8 4 00 00 14.7 +29.5 4.0 ECU. -6.0 ECU. 1.7
 2379 -4.5 1.8 4 00 00 14.7 +29.5 4.0 ECU. -6.0 ECU. 1.7
 2594 -7.5 2.0 15 00 00 23.2 +27.9 65.0 ECU. -6.0 ECU. 2.5
 2618 -7.5 2.0 15 00 00 23.2 +25.7 7.0 ECU. -6.0 ECU. 2.5
 2604 -5.3 2.3 102 10 00 13.5 +35.6 10.0 ECU. -4.3 ECU. 2.3
 2690 -3.0 2.4 102 10 00 12.5 +34.4 11.0 ECU. -4.3 ECU. 2.3
 2718 -0.8 2.4 102 10 00 12.2 +34.1 12.0 ECU. -4.3 ECU. 2.4
 2738 +1.2 2.5 102 10 00 rich +33.4 12.0 ECU. -4.3 ECU. 2.4
 2757 +1.6 2.5 102 10 00 rich +33.4 13.0 ECU. -3.8 ECU. 2.4
 2777 +1.9 2.6 102 20 00 12.0 +33.2 13.0 ECU. -4.1 ECU. 2.5
 2815 +2.3 2.6 102 20 00 rich +33.1 14.0 ECU. -4.0 ECU. 2.5
 2873 +2.8 2.7 103 20 00 rich +33.0 15.0 ECU. -3.9 ECU. 2.6
 2926 +3.4 2.7 102 20 00 rich +31.0 16.0 ECU. -3.9 ECU. 2.6
 2976 +3.8 2.8 102 20 00 rich +27.9 17.0 ECU. -3.8 ECU. 2.7
 3033 +4.3 2.8 102 30 00 rich +25.2 19.0 +20.0 -3.7 ECU. 2.7
 3083 +4.9 2.9 102 30 00 rich +23.4 20.0 +19.6 -3.6 ECU. 2.8
 3103 +5.4 2.9 102 30 00 rich +21.2 21.0 +19.2 -3.5 ECU. 2.8
 3171 +6.2 3.0 102 40 00 rich +19.7 23.0 +18.6 -3.9 ECU. 2.8
 3252 +6.9 3.0 102 40 00 rich +18.3 24.0 +18.2 -3.9 ECU. 3.0
 3310 +7.4 3.2 102 40 00 rich +16.6 27.0 +17.8 -3.8 ECU. 3.0
 3373 +8.2 3.3 102 50 00 rich +14.0 32.0 +17.0 -4.0 ECU. 3.2
 3450 +9.3 3.3 102 50 00 rich +12.5 38.0 +17.0 -4.0 ECU. 3.2
 3512 +10.4 3.4 102 60 00 rich +9.1 44.0 +15.0 -4.0 ECU. 3.3
 3603 +12.0 3.6 102 70 00 rich +7.4 52.0 +14.0 -4.2 ECU. 3.4
 3679 +14.3 3.8 102 80 00 rich +5.8 59.0 +13.0 -4.6 ECU. 3.5
 3800 +16.5 3.8 102 90 00 rich +6.2 62.0 +12.0 -5.0 ECU. 3.6
 3871 +18.1 3.9 102 100 00 rich +7.0 62.0 +12.0 -5.3 ECU. 3.6
 3944 +19.2 3.9 102 100 00 rich +7.9 61.0 +12.0 -5.8 ECU. 3.6
 4055 +19.8 3.9 101 90 00 rich +8.9 63.0 +12.4 -6.3 ECU. 3.5
 4110 +19.6 3.8 101 90 00 rich +8.9 64.0 +13.2 -6.5 ECU. 3.6
 4192 +19.0 3.9 101 90 00 rich +9.2 66.0 +13.8 -6.6 ECU. 3.6
 4340 +18.9 4.0 101 90 00 rich +8.8 68.0 +15.5 -6.7 ECU. 3.7
 4462 +19.0 4.0 101 90 00 rich +9.0 71.0 +16.7 -6.7 ECU. 3.7
 4492 +19.2 4.0 101 100 00 rich +8.3 74.0 +16.1 -6.4 ECU. 3.7
 4585 +19.6 4.0 101 100 00 rich +8.0 77.0 +16.4 -6.4 ECU. 3.8
 4681 +19.8 4.1 102 100 00 rich +8.5 77.0 +16.5 -6.4 ECU. 3.8
 4748 +19.6 4.0 102 90 00 rich +8.8 78.0 +18.0 -6.7 ECU. 3.8
 4859 +19.4 4.0 101 90 00 rich +10.1 78.0 +18.0 -6.7 ECU. 3.8
 4930 +19.0 4.1 101 90 00 rich +11.5 79.0 +18.0 -6.7 ECU. 3.8
 5104 +18.9 4.1 101 90 00 rich +13.4 81.0 +18.0 -6.7 ECU. 3.8
 5096 +19.2 4.1 102 90 00 rich +14.7 82.0 +18.0 -6.7 ECU. 3.8
 5282 +19.0 4.2 102 90 00 rich +15.3 84.0 +18.0 -6.5 ECU. 3.9
 5282 +19.2 4.2 102 90 00 rich +15.4 85.0 +18.0 -6.7 ECU. 3.9
 5376 +19.2 4.2 101 90 00 rich +15.7 86.0 +18.0 -6.5 ECU. 3.9
 5420 +19.2 4.2 102 90 00 rich +15.8 87.0 +18.0 -6.5 ECU. 4.0
 5491 +19.0 4.2 101 90 00 rich +15.3 88.0 +18.0 -6.4 ECU. 4.0
 5630 +18.3 4.3 102 90 00 rich +15.9 89.0 +18.0 -6.4 ECU. 3.9
 5787 +18.3 4.3 102 90 00 rich +16.0 90.0 +18.0 -6.4 ECU. 4.0
 5847 +17.7 4.3 101 90 00 rich +16.7 90.0 +18.0 -6.4 ECU. 4.0
 5797 +17.6 4.3 101 80 00 rich +16.9 88.0 +18.4 -7.0 ECU. 3.9
 5868 +18.3 4.2 100 90 00 rich +16.9 89.0 +18.5 -6.4 ECU. 4.0
 5984 +18.3 4.3 102 90 00 rich +17.4 92.0 +18.8 -6.4 ECU. 4.0
 6038 +17.9 4.3 102 80 00 rich +17.8 91.0 +20.1 -7.0 ECU. 4.0
 6060 +18.3 4.3 102 80 00 rich +18.5 89.0 +20.3 -6.9 ECU. 4.0
 6253 +18.3 4.3 102 90 00 rich +18.4 91.0 +19.7 -6.4 ECU. 4.0
 6277 +17.7 4.3 101 90 00 rich +20.9 92.0 +20.2 -6.4 ECU. 4.0
 6277 +18.3 4.3 101 90 00 rich +21.3 93.0 +20.2 -6.3 ECU. 4.0
 6361 +18.3 4.4 102 90 00 rich +21.0 94.0 +20.7 -6.3 ECU. 4.1
 6447 +17.4 4.3 101 80 00 rich +21.1 93.0 +21.6 -6.3 ECU. 4.0
 6561 +17.2 4.3 101 80 00 rich +21.0 94.0 +22.0 -6.0 ECU. 4.1
 6600 +16.8 4.3 101 80 00 rich +21.2 93.0 +22.1 -6.0 ECU. 4.0
 6640 +17.4 4.3 102 90 00 rich +21.1 95.0 +21.2 -5.8 ECU. 4.1
 6626 +17.7 4.3 101 90 00 rich +21.6 95.0 +21.8 -5.7 ECU. 4.1
 6734 +18.1 4.4 101 80 00 rich +21.5 94.0 +22.9 -6.0 ECU. 4.1
 6775 +17.6 4.3 101 80 00 rich +21.5 94.0 +23.0 -6.0 ECU. 4.1
 6653 +16.3 3.8 11 00 00 rich +41.1 32.0 ECU. -6.0 LCM. 2.4";
		#endregion
		
		#endregion
		
	}
}
